cpu "8085.tbl"
hof "int8"
org 9000h 

LDA 81FFH
CPI 01H
JZ ADD

CPI 02H
JZ SUB 

CPI 03H
JZ MULT

CPI 04H
JZ DIV

ADD: 
MVI C,00H     
LHLD 8200H    
XCHG          
LHLD 8202H    
DAD D         
JNC LABELA
INR C         
LABELA: SHLD 8204H 
MOV A,C      
STA 8206H   
RST 5

SUB:
MVI C,00H    
MVI B,00H    
LHLD 8200H    
XCHG
LHLD 8202H
MOV A,E
SUB L
JNC LABELS1
INR C
LABELS1: MOV E,A
MOV A,D
SUB C
SUB H
JNC LABELS2
INR B
LABELS2: MOV D,A
XCHG
MOV A,B
CPI 01H
JNZ LABEL5
MOV A,L
CMA
MOV L,A 
MOV A,H
CMA 
MOV H,A
INX H

LABEL5:
SHLD 8206H
MOV A,B
STA 8208H
RST 5

MULT:
LHLD 8200H
SPHL
LHLD 8202H
XCHG
LXI H,0000H
LXI B,0000H
NEXT: DAD SP
JNC LOOPM
INX B
LOOPM: DCX D
MOV A,E
ORA D
JNZ NEXT
SHLD 8204H
MOV L,C
MOV H,B
SHLD 8206H
RST 5

DIV:
LXI B,0000H
LHLD 8202H
XCHG
LHLD 8204H
LOOP2: MOV A,L
SUB E
MOV L,A
MOV A,H
SBB D
MOV H,A
JC LOOP1
INX B
JMP LOOP2
LOOP1: DAD D
SHLD 8206H
MOV L,C
MOV H,B
SHLD 8208H
RST 5
